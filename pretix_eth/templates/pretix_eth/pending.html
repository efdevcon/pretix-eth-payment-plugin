{% load i18n %}
{% load static %}
{% load eventurl %}

<br/><br/>
<link rel="stylesheet" type="text/css" href="{% static 'pretix_eth/eth_plugin.css' %}" />

<script src="{% static '3rd_party/web3.min-1.7.5.js' %}"></script>
<script type="text/javascript"
        src="{% static '3rd_party/web3modal-HOTFIX.js' %}"></script>

{% if payment_is_valid %}
<a id="pretix-eth-qr-anchor" href="{{ erc_681_url }}" class="collapse"></a>

<a id="pretix-order-detail-url"
   data-order-detail-url="{% eventurl event 'plugins:pretix_eth:event.order.payment_status' organizer=payment.order.event.organizer.slug event=payment.order.event.slug order=payment.order.code secret=payment.order.secret %}"
   data-chains-json-url="{% static '3rd_party/chains-2022-09-27.json' %}"></a>
<a id="pretix-data-chain-info" data-chain-id="{{ chain_id }}"
   data-network-name="{{ network_name }}"></a>

{% if submitted_transation_hash %}
<script type="module"
        src="/static/pretix_eth/web3modal/run_periodic_check.js"></script>
<div>
    <p>A payment for this order has already been submitted in transaction
        <strong><span
                id="pretix-eth-submitted-transaction-hash">{{ submitted_transation_hash }}</span></strong>.
    </p>
</div>
{% endif %}

{% if order_accepting_payments %}
<div id="pretix-eth-payment-summary">Please pay {{amount_manual}} on
  {{network_name}} using the button below.
</div>
{% include "pretix_eth/web3modal.html" with payment=payment event=event %}
{% endif %}
<p>
  {% blocktrans trimmed %}
  Once you send your payment, our system will automatically check for
  confirmation. Please allow up to several hours. Once confirmed, you will
  get an email notification.
  {% endblocktrans %}
</p>

<p>
    {% blocktrans trimmed %}
    If you want to improve this process, submit a PR to this github repository:
    {% endblocktrans %}
    <a href="https://github.com/esPass/pretix-eth-payment-plugin">
      https://github.com/esPass/pretix-eth-payment-plugin
    </a>
  </p>

{% else %}

  <p>
    <strong>
      {% blocktrans trimmed %}
      Your order is not yet complete.  You may have tried to change the payment
      method but cancelled the process midway.  Please choose a payment method
      by clicking the "Re-try payment or choose another payment method" button
      below.
      {% endblocktrans %}
    </strong>
  </p>

{% endif %}
